<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta name="description" content="PwaniStays - Luxury coastal accommodation in Kenya. Book beachfront villas, apartments & resorts in Mombasa, Diani, Watamu, Nyali, Bamburi & Shanzu. Airport transfers & coastal experiences included. FAQ: What is included in PwaniStays bookings? How do airport transfers work? What amenities are available? What is the cancellation policy?">
    <meta name="keywords" content="kenya beach accommodation, mombasa luxury villas, diani beach resorts, watamu hotels, nyali apartments, bamburi beach houses, shanzu vacation rentals, coastal kenya tourism, airport transfers mombasa, safari coastal packages, faq, frequently asked questions, booking process, cancellation policy">
    <meta name="author" content="PwaniStays - Kenyan Coastal Experts">
    <title>PwaniStays | Luxury Coastal Accommodation Kenya | Beach Villas & Resorts</title>
    
    <!-- Favicon Package for PwaniStays -->
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/android-chrome-512x512.png">
    
    <meta name="theme-color" content="#0d7a5f">
    <meta name="msapplication-TileColor" content="#0d7a5f">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://pwanistays.com/">
    <meta property="og:title" content="PwaniStays – Verified Coastal Apartments">
    <meta property="og:description" content="Trusted apartments across Mombasa & the Kenyan Coast. Book via WhatsApp.">
    <!-- CHANGED: Use logo-mobile.png instead of logo-header.png -->
    <meta property="og:image" content="https://pwanistays.com/logo-mobile.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="PwaniStays Logo - Luxury Coastal Stays">
    <meta property="og:locale" content="en_KE">
    <meta property="og:site_name" content="PwaniStays">
    
    <!-- Twitter / X -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@PwaniStays">
    <meta name="twitter:creator" content="@PwaniStays">
    <meta name="twitter:title" content="PwaniStays – Verified Coastal Apartments">
    <meta name="twitter:description" content="Trusted apartments across Mombasa & the Kenyan Coast. Book via WhatsApp.">
    <!-- CHANGED: Use logo-mobile.png instead of logo-header.png -->
    <meta name="twitter:image" content="https://pwanistays.com/logo-mobile.png">
    <meta name="twitter:image:alt" content="PwaniStays Logo">
    
    <!-- Preload critical resources -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://images.unsplash.com">
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="https://images.unsplash.com">
    
    <!-- STEP 1 — Add Swiper.js CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
    
    <!-- Inline Critical CSS -->
    <style>
        :root {
            --primary: #0d7a5f;
            --primary-light: #0f9b7a;
            --secondary: #f8b400;
            --dark: #1a2b3c;
            --light: #f8f9fa;
            --gray: #6c757d;
            --light-gray: #e9ecef;
            --shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
        
        /* === GLOBAL IMAGE RESET - KILLS ALL STRIPS === */
        img {
            display: block;
            max-width: 100%;
            height: auto;
            margin: 0;
            padding: 0;
            border: 0;
            line-height: 0;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            overflow-x: hidden;
            background: #fff;
        }
        
        /* Header */
        header {
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.98);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
        }
        
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 5%;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Logo link styling */
        .logo-link {
            display: flex;
            align-items: center;
            text-decoration: none;
            line-height: 1;
        }
        
        /* Responsive logo styles */
        .logo-desktop {
            display: inline-block;
        }
        
        .logo-mobile {
            display: none;
        }
        
        /* On mobile screens, hide desktop and show mobile logo */
        @media (max-width: 768px) {
            .logo-desktop {
                display: none;
            }
            
            .logo-mobile {
                display: inline-block;
            }
        }
        
        /* Navigation */
        .nav-links {
            display: flex;
            list-style: none;
            gap: 30px;
            align-items: center;
        }
        
        .nav-links a {
            font-weight: 500;
            transition: var(--transition);
            position: relative;
            text-decoration: none;
            color: var(--dark);
        }
        
        .nav-links a:hover,
        .nav-links a.active {
            color: var(--primary);
        }
        
        .nav-links a.active::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--primary);
        }
        
        /* PHASE 4 — Header Search Icon */
        .header-search-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        #headerSearch {
            width: 200px;
            padding: 8px 15px;
            border: 2px solid var(--primary);
            border-radius: 20px;
            font-size: 0.9rem;
            transition: var(--transition);
            display: none;
        }
        
        #headerSearch.show {
            display: block;
        }
        
        #searchToggle {
            background: none;
            border: none;
            font-size: 1.2rem;
            color: var(--dark);
            cursor: pointer;
            padding: 5px;
            transition: var(--transition);
        }
        
        #searchToggle:hover {
            color: var(--primary);
        }
        
        .btn-book {
            background: var(--secondary);
            color: var(--dark);
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
            transition: var(--transition);
            text-decoration: none;
            display: inline-block;
        }
        
        .btn-book:hover {
            background: #e09c00;
            transform: translateY(-2px);
        }
        
        .menu-toggle {
            display: none;
            font-size: 1.5rem;
            background: none;
            border: none;
            cursor: pointer;
            color: var(--dark);
        }
        
        /* === CHANGE 3: HERO SECTION - 2-IMAGE CAROUSEL === */
        .hero {
            height: 100vh;
            min-height: 600px;
            margin-top: 80px;
            padding: 0 20px;
            position: relative;
        }
        
        .hero-carousel {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        
        .hero-carousel .swiper {
            width: 100%;
            height: 100%;
        }
        
        .hero-carousel .swiper-slide {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .hero-slide {
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            position: relative;
        }
        
        .hero-slide::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7));
        }
        
        .hero-content {
            position: relative;
            z-index: 2;
            text-align: center;
            color: white;
            padding-top: 100px;
        }
        
        .hero-content h2 {
            font-size: clamp(1.8rem, 5vw, 3rem);
            margin-bottom: 15px;
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5);
        }
        
        .hero-content p {
            font-size: clamp(1rem, 2vw, 1.2rem);
            margin-bottom: 30px;
            opacity: 0.9;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* UPDATED: Search Box with 3 inputs */
        .search-box {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-top: 30px;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .search-input {
            display: flex;
            align-items: center;
            gap: 10px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid var(--light-gray);
        }
        
        .search-input i {
            color: var(--primary);
            min-width: 20px;
        }
        
        .search-input select,
        .search-input input {
            border: none;
            outline: none;
            width: 100%;
            font-size: 1rem;
            background: transparent;
            font-family: inherit;
            cursor: pointer;
        }
        
        .search-input input[readonly] {
            cursor: pointer;
            background: transparent;
        }
        
        /* UPDATED: Button container spans all 3 columns */
        .search-btn-container {
            grid-column: span 3;
            display: flex;
            justify-content: center;
            margin-top: 10px;
        }
        
        .search-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1.1rem;
            min-width: 200px;
        }
        
        .search-btn:hover {
            background: var(--primary-light);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(13, 122, 95, 0.3);
        }
        
        /* Date Range Input */
        .date-range-input {
            position: relative;
            cursor: pointer;
        }
        
        .date-range-input input {
            width: 100%;
        }
        
        /* Section Common Styles */
        section {
            padding: 100px 5%;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 50px;
        }
        
        .section-title h2 {
            font-size: 2.5rem;
            color: var(--dark);
            margin-bottom: 15px;
            position: relative;
            display: inline-block;
        }
        
        .section-title h2::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 70px;
            height: 3px;
            background: var(--secondary);
        }
        
        .section-title p {
            color: var(--gray);
            max-width: 600px;
            margin: 0 auto;
        }
        
        /* Results Section */
        #searchResults {
            background: var(--light);
        }
        
        .properties-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* === PART 1: FINAL FIX FOR STRIP ABOVE IMAGE === */
        .property-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            position: relative;
        }
        
        .property-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .property-content {
            padding: 25px;
        }
        
        /* ✅ FIX 4 — ENSURE GALLERY CONTAINER DOES NOT COLLAPSE */
        .property-gallery {
            width: 100%;
            position: relative;
        }
        
        /* ✅ FIX 2 — FORCE MAIN IMAGE HEIGHT (CRITICAL) */
        .mainSwiper {
            width: 100%;
            height: 260px;
            border-radius: 14px;
            overflow: hidden;
        }
        
        .mainSwiper img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        
        .mainSwiper .swiper-pagination {
            bottom: 10px !important;
        }
        
        .mainSwiper .swiper-pagination-bullet {
            background: white;
            opacity: 0.7;
        }
        
        .mainSwiper .swiper-pagination-bullet-active {
            background: var(--primary);
            opacity: 1;
        }
        
        /* ✅ FIX 3 — THUMBNAIL STRIP (PREVENT COLLISION) */
        .thumbSwiper {
            margin-top: 8px;
            height: 70px;
        }
        
        .thumbSwiper .swiper-slide {
            height: 100%;
            opacity: 0.6;
            cursor: pointer;
        }
        
        .thumbSwiper .swiper-slide-thumb-active {
            opacity: 1;
        }
        
        .thumbSwiper img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 6px;
        }
        
        .property-title {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: var(--dark);
        }
        
        .property-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        .property-location {
            color: var(--primary);
            font-weight: 500;
        }
        
        .property-type {
            background: #f0f8f4;
            color: var(--primary);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        /* === PART 2: AMENITIES AS POINTS + AUTO-TRUNCATION === */
        .property-desc {
            list-style: none;
            padding: 0;
            margin: 10px 0;
        }
        
        .property-desc li {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            font-size: 0.95rem;
            line-height: 1.4;
            margin-bottom: 6px;
            color: var(--gray);
        }
        
        .property-desc li:before {
            content: "•";
            color: var(--primary);
            font-weight: bold;
            min-width: 10px;
        }
        
        .view-more-btn {
            background: none;
            border: none;
            color: var(--primary);
            font-weight: 600;
            cursor: pointer;
            padding: 0;
            margin-top: 4px;
            font-size: 0.9rem;
            transition: var(--transition);
            display: inline-block;
        }
        
        .view-more-btn:hover {
            color: var(--primary-light);
            text-decoration: underline;
        }
        
        .property-price {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 20px;
        }
        
        .property-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 20px;
            border-top: 1px solid var(--light-gray);
        }
        
        .property-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        /* FIXED: Show beds from property.beds */
        .property-beds {
            color: var(--dark);
            font-weight: 500;
            font-size: 0.95rem;
        }
        
        .property-beds i {
            color: var(--primary);
            margin-right: 5px;
        }
        
        /* REMOVED: property-code section */
        .property-code {
            display: none;
        }
        
        .no-properties {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray);
            font-size: 1.1rem;
            grid-column: 1 / -1;
        }
        
        .loading-spinner {
            text-align: center;
            padding: 40px;
            color: var(--primary);
            grid-column: 1 / -1;
        }
        
        .loading-spinner i {
            font-size: 2rem;
            margin-bottom: 15px;
        }
        
        .results-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: var(--light);
            border-radius: 10px;
            max-width: 800px;
            margin: 0 auto 40px;
        }
        
        .results-header h3 {
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .results-header p {
            color: var(--gray);
            font-size: 1rem;
        }
        
        .clear-filters {
            display: inline-block;
            margin-top: 15px;
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
            border-bottom: 1px dashed var(--primary);
            cursor: pointer;
        }
        
        .clear-filters:hover {
            color: var(--primary-light);
            border-bottom-color: var(--primary-light);
        }
        
        /* Featured Stays - UPDATED with View All button */
        .featured-stays {
            background: white;
        }
        
        .stays-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto 50px;
        }
        
        .stay-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }
        
        .stay-card:hover {
            transform: translateY(-10px);
        }
        
        .stay-img {
            height: 200px;
            background: var(--light-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .stay-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .stay-content {
            padding: 25px;
        }
        
        .stay-content h3 {
            margin-bottom: 10px;
            color: var(--dark);
        }
        
        .stay-location {
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .stay-features {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            color: var(--gray);
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .stay-features span {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
        }
        
        .amenities {
            margin: 15px 0;
            min-height: 40px;
        }
        
        .amenity-tag {
            display: inline-block;
            background: #f0f8f4;
            color: #0d7a5f;
            padding: 4px 10px;
            margin: 2px;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .stay-price {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--light-gray);
        }
        
        .price-amount {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary);
        }
        
        .price-period {
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        .btn-primary {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 12px 30px;
            border-radius: 30px;
            font-weight: 600;
            transition: var(--transition);
            border: none;
            cursor: pointer;
            text-decoration: none;
            font-size: 1rem;
        }
        
        .btn-primary:hover {
            background: var(--primary-light);
            transform: translateY(-3px);
            box-shadow: var(--shadow);
        }
        
        .view-all-container {
            text-align: center;
            margin-top: 30px;
        }
        
        .btn-secondary {
            display: inline-block;
            background: transparent;
            color: var(--primary);
            padding: 12px 30px;
            border-radius: 30px;
            font-weight: 600;
            border: 2px solid var(--primary);
            transition: var(--transition);
            text-decoration: none;
        }
        
        .btn-secondary:hover {
            background: var(--primary);
            color: white;
        }
        
        /* UPDATED: Services Section with WhatsApp CTAs */
        .services {
            background: var(--light);
        }
        
        .services-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .service-card {
            background: white;
            padding: 40px 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .service-card:hover {
            transform: translateY(-10px);
        }
        
        .service-icon {
            width: 70px;
            height: 70px;
            background: var(--primary-light);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 1.8rem;
        }
        
        .service-card h3 {
            margin-bottom: 15px;
            color: var(--dark);
            font-size: 1.3rem;
        }
        
        .service-card p {
            color: var(--gray);
            margin-bottom: 20px;
            flex-grow: 1;
        }
        
        /* NEW: WhatsApp button for services */
        .service-whatsapp-btn {
            display: inline-block;
            background: #25D366;
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            font-weight: 600;
            transition: var(--transition);
            text-decoration: none;
            border: none;
            cursor: pointer;
            font-size: 0.95rem;
            margin-top: auto;
            width: 100%;
        }
        
        .service-whatsapp-btn:hover {
            background: #128C7E;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(37, 211, 102, 0.3);
        }
        
        .service-whatsapp-btn i {
            margin-right: 8px;
        }
        
        /* Why Choose Us */
        .why-us {
            background: var(--light);
        }
        
        .features-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .feature {
            text-align: center;
            padding: 30px 20px;
        }
        
        .feature i {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 20px;
        }
        
        .feature h3 {
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        /* Testimonials - FIXED with proper display */
        .testimonials {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }
        
        .testimonials-container {
            max-width: 1000px;
            margin: 0 auto;
            position: relative;
        }
        
        .testimonial-slider {
            position: relative;
            overflow: hidden;
            height: 350px;
            margin-bottom: 50px;
        }
        
        .testimonial-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 0.5s ease;
            padding: 40px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .testimonial-slide.active {
            opacity: 1;
        }
        
        .testimonial-content {
            text-align: center;
            max-width: 800px;
            width: 100%;
        }
        
        .testimonial-content p {
            font-size: 1.2rem;
            line-height: 1.8;
            color: var(--dark);
            margin-bottom: 30px;
            font-style: italic;
            position: relative;
        }
        
        .testimonial-content p::before {
            content: '"';
            font-size: 4rem;
            color: var(--primary-light);
            position: absolute;
            top: -30px;
            left: -30px;
            opacity: 0.3;
        }
        
        .testimonial-content p::after {
            content: '"';
            font-size: 4rem;
            color: var(--primary-light);
            position: absolute;
            bottom: -50px;
            right: -30px;
            opacity: 0.3;
        }
        
        .testimonial-author {
            margin-top: 30px;
        }
        
        .testimonial-author h4 {
            color: var(--primary);
            margin-bottom: 5px;
            font-size: 1.1rem;
        }
        
        .testimonial-author p {
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 10px;
        }
        
        .rating {
            color: var(--secondary);
            font-size: 1.2rem;
            letter-spacing: 3px;
        }
        
        .testimonial-prev,
        .testimonial-next {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: var(--primary);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5rem;
            transition: var(--transition);
            z-index: 10;
        }
        
        .testimonial-prev:hover,
        .testimonial-next:hover {
            background: var(--primary-light);
            transform: translateY(-50%) scale(1.1);
        }
        
        .testimonial-prev {
            left: -70px;
        }
        
        .testimonial-next {
            right: -70px;
        }
        
        .testimonial-dots {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 30px;
        }
        
        .testimonial-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--light-gray);
            border: none;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .testimonial-dot.active {
            background: var(--primary);
            transform: scale(1.2);
        }
        
        /* NEW: Leave Feedback Section */
        .leave-feedback {
            background: white;
            padding: 80px 5%;
            margin-top: 50px;
        }
        
        .feedback-form {
            background: var(--light);
            padding: 40px;
            border-radius: 15px;
            max-width: 800px;
            margin: 0 auto;
            box-shadow: var(--shadow);
        }
        
        .feedback-form h3 {
            text-align: center;
            margin-bottom: 30px;
            color: var(--dark);
            font-size: 1.5rem;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark);
            font-weight: 500;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 15px;
            border: 1px solid var(--light-gray);
            border-radius: 10px;
            font-size: 1rem;
            transition: var(--transition);
            font-family: inherit;
        }
        
        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(13, 122, 95, 0.1);
        }
        
        .star-rating {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .star {
            font-size: 2rem;
            color: #ddd;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .star:hover,
        .star.selected {
            color: var(--secondary);
            transform: scale(1.1);
        }
        
        .rating-text {
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 20px;
        }
        
        .feedback-btn {
            width: 100%;
            padding: 15px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1rem;
            margin-top: 20px;
        }
        
        .feedback-btn:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
        }
        
        .feedback-btn:disabled {
            background: var(--gray);
            cursor: not-allowed;
            transform: none;
        }
        
        /* Coastal Destinations */
        .destinations {
            background: white;
        }
        
        .destinations-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .destination-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }
        
        .destination-card:hover {
            transform: translateY(-10px);
        }
        
        .destination-image {
            height: 200px;
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: flex-end;
            padding: 20px;
            color: white;
        }
        
        .destination-image h3 {
            font-size: 1.5rem;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
        }
        
        .destination-content {
            padding: 25px;
        }
        
        .destination-content p {
            color: var(--gray);
            margin-bottom: 20px;
        }
        
        .btn-small {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            transition: var(--transition);
            text-decoration: none;
        }
        
        .btn-small:hover {
            background: var(--primary-light);
        }
        
        /* Contact Section */
        .contact {
            background: white;
        }
        
        .contact-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 50px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .contact-info {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        .contact-item {
            display: flex;
            align-items: flex-start;
            gap: 20px;
        }
        
        .contact-item i {
            font-size: 1.5rem;
            color: var(--primary);
            margin-top: 5px;
            min-width: 24px;
        }
        
        .contact-item h3 {
            margin-bottom: 5px;
            font-size: 1.1rem;
        }
        
        .contact-item p {
            color: var(--gray);
        }
        
        .contact-item a {
            color: inherit;
            text-decoration: none;
        }
        
        .contact-item a:hover {
            color: var(--primary);
            text-decoration: underline;
        }
        
        small {
            display: block;
            color: var(--gray);
            font-size: 0.85rem;
            margin-top: 5px;
        }
        
        .contact-form {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: var(--shadow);
        }
        
        .contact-form h3 {
            margin-bottom: 30px;
            text-align: center;
            font-size: 1.3rem;
        }
        
        .submit-btn {
            width: 100%;
            padding: 15px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1rem;
        }
        
        .submit-btn:hover {
            background: var(--primary-light);
        }
        
        /* Footer */
        footer {
            background: var(--dark);
            color: white;
            padding-top: 80px;
        }
        
        .footer-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .footer-col h3 {
            margin-bottom: 25px;
            font-size: 1.3rem;
            color: white;
        }
        
        .footer-col ul {
            list-style: none;
        }
        
        .footer-col ul li {
            margin-bottom: 12px;
        }
        
        .footer-col ul li a {
            transition: var(--transition);
            display: inline-block;
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
        }
        
        .footer-col ul li a:hover {
            color: var(--secondary);
            padding-left: 5px;
        }
        
        .footer-col p {
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 20px;
            line-height: 1.7;
        }
        
        .footer-logo {
            display: inline-block;
            margin-bottom: 20px;
            line-height: 1;
        }
        
        .footer-logo-icon {
            font-size: 2rem;
            color: white;
            line-height: 1;
        }
        
        .footer-logo h2 {
            font-size: 1.5rem;
            color: white;
            font-weight: 600;
            line-height: 1;
            margin: 0;
        }
        
        .footer-logo span {
            color: var(--secondary);
        }
        
        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .social-links a {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            color: white;
            text-decoration: none;
        }
        
        .social-links a:hover {
            background: var(--primary);
            transform: translateY(-3px);
        }
        
        .footer-bottom {
            text-align: center;
            padding: 30px;
            margin-top: 50px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }
        
        .footer-bottom a {
            color: var(--secondary);
            text-decoration: none;
            margin: 0 10px;
        }
        
        .footer-bottom a:hover {
            text-decoration: underline;
        }
        
        /* WhatsApp Float */
        .whatsapp-float {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: #25D366;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            box-shadow: 0 4px 20px rgba(37, 211, 102, 0.5);
            z-index: 1000;
            transition: var(--transition);
            text-decoration: none;
        }
        
        .whatsapp-float:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(37, 211, 102, 0.7);
        }
        
        /* Calendar Styles - FIXED: Made more compact and fixed selection issues */
        .calendar-overlay {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            z-index: 2000;
            padding: 15px;
            width: 380px;
            max-width: 90vw;
            max-height: 500px;
            overflow-y: hidden;
            border: 2px solid var(--primary);
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, -48%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light-gray);
        }
        
        .calendar-header h4 {
            color: var(--dark);
            font-size: 1rem;
            margin: 0;
            font-weight: 600;
        }
        
        .calendar-nav {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .calendar-header button {
            background: var(--primary);
            color: white;
            border: none;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1rem;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .calendar-header button:hover {
            background: var(--primary-light);
            transform: scale(1.1);
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 3px;
            margin-bottom: 10px;
        }
        
        .calendar-day-header {
            padding: 8px 2px;
            text-align: center;
            font-weight: 600;
            color: var(--primary);
            font-size: 0.75rem;
            background: #f8f9fa;
            border-radius: 4px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .calendar-day {
            padding: 8px 2px;
            text-align: center;
            border-radius: 4px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            border: 2px solid transparent;
            color: var(--dark);
            background: white;
            font-size: 0.8rem;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 32px;
        }
        
        .calendar-day:hover {
            background: #e8f4f1;
            border-color: var(--primary-light);
        }
        
        .calendar-day.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            font-weight: 600;
            box-shadow: 0 2px 5px rgba(13, 122, 95, 0.3);
        }
        
        .calendar-day.between {
            background: #e8f4f1;
            color: var(--primary);
            border-color: var(--primary-light);
        }
        
        .calendar-day.disabled {
            color: #ccc;
            cursor: not-allowed;
            background: #f9f9f9;
        }
        
        .calendar-day.disabled:hover {
            background: #f9f9f9;
            border-color: transparent;
        }
        
        .calendar-day.today {
            background: var(--secondary);
            color: var(--dark);
            font-weight: 600;
        }
        
        .calendar-actions {
            display: flex;
            justify-content: space-between;
            gap: 10px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--light-gray);
        }
        
        .calendar-actions button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
        }
        
        .calendar-clear {
            background: #f8f9fa;
            color: var(--gray);
        }
        
        .calendar-clear:hover {
            background: #e9ecef;
        }
        
        .calendar-apply {
            background: var(--primary);
            color: white;
        }
        
        .calendar-apply:hover {
            background: var(--primary-light);
        }
        
        .calendar-backdrop {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1999;
            animation: fadeIn 0.3s ease;
        }
        
        .selected-dates-display {
            margin-top: 10px;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 8px;
            display: flex;
            justify-content: space-around;
            font-size: 0.85rem;
        }
        
        .selected-dates-display div {
            text-align: center;
        }
        
        .selected-dates-display strong {
            display: block;
            color: var(--primary);
            margin-bottom: 3px;
            font-size: 0.8rem;
        }
        
        /* Responsive Design */
        @media (max-width: 992px) {
            .search-box {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .search-btn-container {
                grid-column: span 1;
                margin-top: 5px;
            }
            
            .testimonial-prev {
                left: 10px;
            }
            
            .testimonial-next {
                right: 10px;
            }
            
            .services-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .properties-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .menu-toggle {
                display: block;
            }
            
            .nav-links {
                position: fixed;
                top: 80px;
                left: -100%;
                width: 100%;
                height: calc(100vh - 80px);
                background: white;
                flex-direction: column;
                align-items: center;
                justify-content: flex-start;
                padding-top: 50px;
                gap: 30px;
                transition: var(--transition);
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            }
            
            .nav-links.active {
                left: 0;
            }
            
            .header-search-container {
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: white;
                padding: 15px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.1);
                display: none;
            }
            
            .header-search-container.show {
                display: block;
            }
            
            #headerSearch {
                width: 100%;
            }
            
            .testimonial-slider {
                height: 400px;
            }
            
            section {
                padding: 80px 5%;
            }
            
            .section-title h2 {
                font-size: 2rem;
            }
            
            .hero {
                margin-top: 70px;
                padding: 0 15px;
            }
            
            .search-box {
                padding: 20px;
            }
            
            .contact-form {
                padding: 30px 20px;
            }
            
            .feedback-form {
                padding: 30px 20px;
            }
            
            .whatsapp-float {
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
                bottom: 15px;
                right: 15px;
            }
            
            .services-container {
                grid-template-columns: 1fr;
            }
            
            .properties-grid {
                grid-template-columns: 1fr;
            }
            
            .calendar-overlay {
                width: 340px;
                padding: 12px;
            }
            
            .calendar-day {
                padding: 6px 1px;
                font-size: 0.75rem;
                height: 30px;
                min-width: 30px;
            }
            
            .calendar-day-header {
                padding: 6px 1px;
                font-size: 0.7rem;
                height: 30px;
            }
            
            .testimonial-content p::before,
            .testimonial-content p::after {
                display: none;
            }
            
            /* ✅ FIX 5 — MOBILE SAFETY (IMPORTANT) */
            .thumbSwiper {
                display: none;
            }

            .mainSwiper {
                height: 220px;
            }
        }
        
        @media (max-width: 576px) {
            .hero-content h2 {
                font-size: 1.8rem;
            }
            
            .section-title h2 {
                font-size: 1.8rem;
            }
            
            .testimonial-content p {
                font-size: 1rem;
            }
            
            .footer-logo {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
            
            .footer-logo h2 {
                font-size: 1.3rem;
            }
            
            .calendar-overlay {
                width: 320px;
                padding: 10px;
                max-height: 450px;
            }
            
            .calendar-day {
                padding: 5px 0;
                font-size: 0.7rem;
                height: 28px;
                min-width: 28px;
            }
            
            .calendar-day-header {
                padding: 5px 0;
                font-size: 0.65rem;
                height: 28px;
            }
            
            .star {
                font-size: 1.5rem;
            }
            
            .calendar-actions button {
                padding: 8px;
                font-size: 0.8rem;
            }
            
            .mainSwiper {
                height: 200px;
            }
        }
        
        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        :focus {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }
        
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }

        /* ✅ FIX 1 — ADD THESE REQUIRED SWIPER CSS RULES */
        /* ===== SWIPER CORE FIX ===== */
        .swiper {
            width: 100%;
            height: 100%;
        }

        .swiper-wrapper {
            display: flex;
        }

        .swiper-slide {
            flex-shrink: 0;
            width: 100%;
            height: 100%;
        }

        /* ===== MOBILE SEARCH BAR FIX ===== */
        @media (max-width: 768px) {
            .header-search-container {
                display: flex !important;
                position: static;
                background: transparent;
                padding: 10px 0;
                box-shadow: none;
                width: 100%;
                margin-top: 10px;
            }
            
            #headerSearch {
                display: block !important;
                width: 100%;
                font-size: 16px;
            }
            
            #searchToggle {
                display: none;
            }
            
            header .search-container,
            header .search-wrapper {
                display: block !important;
                width: 100%;
            }
        }
    </style>
    
    <!-- Defer non-critical CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" 
          media="print" onload="this.media='all'" crossorigin="anonymous">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://pwanistays.com">
</head>
<body>
    <!-- WhatsApp Float -->
    <a href="https://wa.me/254738544784?text=Hello%20PwaniStays!%20I%20need%20help%20with%20a%20booking" 
       class="whatsapp-float" 
       target="_blank"
       rel="noopener noreferrer"
       aria-label="Chat on WhatsApp">
        <i class="fab fa-whatsapp" aria-hidden="true"></i>
    </a>

    <!-- Header -->
    <header role="banner">
        <nav class="navbar" aria-label="Main navigation">
            <!-- UPDATED HEADER LOGO -->
            <a href="#home" class="logo-link">
                <img src="/logo-header.png" 
                     alt="PwaniStays - Luxury Coastal Stays" 
                     class="logo-desktop"
                     style="height: 50px; width: auto;">
                <img src="/logo-mobile.png" 
                     alt="PwaniStays" 
                     class="logo-mobile"
                     style="height: 50px; width: auto;">
            </a>
            <button class="menu-toggle" aria-label="Toggle menu" aria-expanded="false">
                <i class="fas fa-bars" aria-hidden="true"></i>
            </button>
            <ul class="nav-links" role="menubar">
                <li role="none"><a href="#home" class="active" role="menuitem">Home</a></li>
                <li role="none"><a href="#stays" role="menuitem">Featured</a></li>
                <li role="none"><a href="#services" role="menuitem">Services</a></li>
                <li role="none"><a href="#about" role="menuitem">About</a></li>
                <li role="none"><a href="#testimonials" role="menuitem">Reviews</a></li>
                <li role="none"><a href="#contact" role="menuitem">Contact</a></li>
                <!-- PHASE 4 — Header Search Icon -->
                <li role="none" class="header-search-container" id="mobileSearchContainer">
                    <button id="searchToggle" aria-label="Toggle search">
                        <i class="fas fa-search"></i>
                    </button>
                    <input type="text" id="headerSearch" placeholder="Search beachfront, villa, Nyali..." aria-label="Search properties">
                </li>
                <!-- UPDATED: Book Now button now scrolls to contact section -->
                <li role="none"><a href="#contact" class="btn-book" role="menuitem">Book Now</a></li>
            </ul>
        </nav>
    </header>

    <!-- CHANGE 3: Hero Section - NOW A 2-IMAGE CAROUSEL -->
    <section class="hero" id="home" role="region" aria-label="Hero section">
        <!-- Hero Carousel -->
        <div class="hero-carousel">
            <div class="swiper heroSwiper">
                <div class="swiper-wrapper">
                    <!-- Slide 1: Ocean-facing balcony / exterior (NEW IMAGE - NO DIVER) -->
                    <div class="swiper-slide">
                        <div class="hero-slide" style="background-image: url('https://images.unsplash.com/photo-1613977257363-707ba9348227?ixlib=rb-4.0.3&auto=format&fit=crop&w=1950&q=80');"></div>
                    </div>
                    <!-- Slide 2: Bright interior with coastal feel -->
                    <div class="swiper-slide">
                        <div class="hero-slide" style="background-image: url('https://images.unsplash.com/photo-1512917774080-9991f1c4c750?ixlib=rb-4.0.3&auto=format&fit=crop&w=1950&q=80');"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="hero-content">
            <h1 class="sr-only">PwaniStays - Luxury Coastal Accommodation in Kenya</h1>
            <h2>Experience Luxury on the Kenyan Coast</h2>
            <p>Premium beachfront villas, luxury apartments, and exclusive resorts across Mombasa, Diani, Watamu, Nyali, Bamburi & Shanzu with seamless airport transfers</p>
            
            <!-- UPDATED: Search Box with 3 inputs - ADDED VILLA OPTION -->
            <div class="search-box" role="search">
                <div class="search-input">
                    <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
                    <select id="searchLocation" aria-label="Select destination">
                        <option value="">Any Location</option>
                        <option value="Mombasa">Mombasa</option>
                        <option value="Nyali">Nyali</option>
                        <option value="Bamburi">Bamburi</option>
                        <option value="Mtwapa">Mtwapa</option>
                        <option value="Shanzu">Shanzu</option>
                        <option value="Diani">Diani</option>
                        <option value="Watamu">Watamu</option>
                        <option value="Malindi">Malindi</option>
                        <option value="Kilifi">Kilifi</option>
                    </select>
                </div>
                <div class="search-input date-range-input" onclick="showCalendar()">
                    <i class="fas fa-calendar" aria-hidden="true"></i>
                    <input type="text" placeholder="Check-in → Check-out" id="dateRange" aria-label="Select check-in and check-out dates" readonly>
                </div>
                <div class="search-input">
                    <i class="fas fa-home" aria-hidden="true"></i>
                    <!-- UPDATED: Property type dropdown with normalized values - ADDED VILLA -->
                    <select id="propertyType" aria-label="Property type">
                        <option value="">Any Type</option>
                        <option value="studio">Studio</option>
                        <option value="1br">1 Bedroom</option>
                        <option value="2br">2 Bedrooms</option>
                        <option value="3br">3 Bedrooms</option>
                        <option value="4br">4 Bedrooms</option>
                        <option value="5br">5 Bedrooms</option>
                        <option value="villa">Villa</option>
                    </select>
                </div>
                <div class="search-btn-container">
                    <button class="search-btn" onclick="searchProperties()" aria-label="Search properties">
                        <i class="fas fa-search" aria-hidden="true"></i> Search Properties
                    </button>
                </div>
            </div>
            
            <!-- Calendar Backdrop -->
            <div id="calendarBackdrop" class="calendar-backdrop" onclick="hideCalendar()"></div>
            
            <!-- Calendar Container -->
            <div id="calendarContainer" class="calendar-overlay"></div>
        </div>
    </section>

    <!-- Results Section -->
    <section id="searchResults" class="properties-section" style="display: none;">
        <div class="section-title">
            <h2>Search Results</h2>
            <p id="resultsCount">Loading properties...</p>
        </div>
        
        <div id="resultsHeader" class="results-header" style="display: none;">
            <h3 id="searchCriteria"></h3>
            <p id="datesCriteria"></p>
            <a class="clear-filters" onclick="clearSearch()">Clear filters and show all properties</a>
        </div>
        
        <div id="propertyList" class="properties-grid">
            <!-- Properties will be loaded here -->
        </div>
    </section>

    <!-- Featured Stays - UPDATED with View All button -->
    <section class="featured-stays" id="stays">
        <div class="section-title">
            <h2>Featured Properties</h2>
            <p>Hand-selected luxury accommodations across Kenya's finest beach destinations</p>
        </div>
        <div id="featuredProperties" class="stays-container">
            <div class="loading-spinner">
                <i class="fas fa-spinner fa-spin"></i> Loading featured properties...
            </div>
        </div>
        <div class="view-all-container">
            <button class="btn-secondary" onclick="showAllProperties()">
                <i class="fas fa-eye"></i> View All Properties
            </button>
        </div>
    </section>

    <!-- UPDATED: Services Section with WhatsApp CTAs -->
    <section class="services" id="services" role="region" aria-label="Our services">
        <div class="section-title">
            <h2>Complete Coastal Experience</h2>
            <p>End-to-end travel solutions for your Kenyan coastal vacation</p>
        </div>
        <div class="services-container">
            <div class="service-card" role="article">
                <div class="service-icon">
                    <i class="fas fa-umbrella-beach" aria-hidden="true"></i>
                </div>
                <h3>Coastal Accommodation</h3>
                <p>Premium apartments, villas, and resorts across all major Kenyan coastal destinations - beachfront and prime locations. From budget-friendly options to luxurious 5-bedroom villas with private pools, we have the perfect stay for every traveler.</p>
                <button class="service-whatsapp-btn" onclick="serviceEnquiry('Coastal Accommodation')">
                    <i class="fab fa-whatsapp"></i> Enquire About Stays
                </button>
            </div>
            <div class="service-card" role="article">
                <div class="service-icon">
                    <i class="fas fa-plane-arrival" aria-hidden="true"></i>
                </div>
                <h3>Seamless Transfers</h3>
                <p>Private airport transfers from Moi International (MBA), Ukunda (UKA), and SGR stations with meet & greet service. Our professional drivers ensure safe, comfortable transfers in air-conditioned vehicles with complimentary bottled water.</p>
                <button class="service-whatsapp-btn" onclick="serviceEnquiry('Airport Transfers')">
                    <i class="fab fa-whatsapp"></i> Book Transfers
                </button>
            </div>
            <div class="service-card" role="article">
                <div class="service-icon">
                    <i class="fas fa-ship" aria-hidden="true"></i>
                </div>
                <h3>Marine Experiences</h3>
                <p>Dhow cruises, snorkeling at Marine Parks, deep sea fishing, and dolphin watching tours with certified guides. We arrange all equipment, permits, and transportation for unforgettable coastal adventures.</p>
                <button class="service-whatsapp-btn" onclick="serviceEnquiry('Marine Experiences')">
                    <i class="fab fa-whatsapp"></i> Plan Marine Tours
                </button>
            </div>
        </div>
    </section>

    <!-- Why Choose Us -->
    <section class="why-us" id="about" role="region" aria-label="Why choose us">
        <div class="section-title">
            <h2>Why Choose PwaniStays?</h2>
            <p>Local expertise meets international standards</p>
        </div>
        <div class="features-container">
            <div class="feature" role="article">
                <i class="fas fa-award" aria-hidden="true"></i>
                <h3>Coastal Specialists</h3>
                <p>Deep local knowledge of Kenya's coastline with verified partnerships across all major coastal destinations.</p>
            </div>
            <div class="feature" role="article">
                <i class="fas fa-shield-alt" aria-hidden="true"></i>
                <h3>Property Vetting</h3>
                <p>Every property personally inspected for safety, cleanliness, and guest satisfaction.</p>
            </div>
            <div class="feature" role="article">
                <i class="fas fa-handshake" aria-hidden="true"></i>
                <h3>Direct Owner Rates</h3>
                <p>We work directly with property owners to offer you the best rates without middlemen fees.</p>
            </div>
            <div class="feature" role="article">
                <i class="fas fa-headset" aria-hidden="true"></i>
                <h3>Multi-lingual Support</h3>
                <p>Customer service in English, Swahili, French, German, and Italian for international guests.</p>
            </div>
        </div>
    </section>

    <!-- Testimonials - FIXED with proper display -->
    <section class="testimonials" id="testimonials" role="region" aria-label="Client testimonials">
        <div class="section-title">
            <h2>What Our Guests Say</h2>
            <p>Real experiences from local and international travelers</p>
        </div>
        <div class="testimonials-container">
            <div class="testimonial-slider">
                <!-- Testimonial 1 -->
                <div class="testimonial-slide active">
                    <div class="testimonial-content">
                        <p>"Absolutely stunning villa in Nyali! The PwaniStays team made our family vacation seamless from airport pickup to checkout. The kids loved the private pool!"</p>
                        <div class="testimonial-author">
                            <h4>Sarah Johnson</h4>
                            <p>From London, UK</p>
                            <div class="rating">★★★★★</div>
                        </div>
                    </div>
                </div>
                
                <!-- Testimonial 2 -->
                <div class="testimonial-slide">
                    <div class="testimonial-content">
                        <p>"As a local from Nairobi looking for a coastal getaway, PwaniStays provided excellent service. The Bamburi beach apartment was perfect and the rates were very competitive."</p>
                        <div class="testimonial-author">
                            <h4>David Mwangi</h4>
                            <p>From Nairobi, Kenya</p>
                            <div class="rating">★★★★★</div>
                        </div>
                    </div>
                </div>
                
                <!-- Testimonial 3 -->
                <div class="testimonial-slide">
                    <div class="testimonial-content">
                        <p>"Our honeymoon in Diani was magical thanks to PwaniStays. They arranged everything from the villa to a romantic dhow cruise. Highly recommended!"</p>
                        <div class="testimonial-author">
                            <h4>Maria & Thomas</h4>
                            <p>From Berlin, Germany</p>
                            <div class="rating">★★★★★</div>
                        </div>
                    </div>
                </div>
                
                <!-- Testimonial 4 -->
                <div class="testimonial-slide">
                    <div class="testimonial-content">
                        <p>"The service was exceptional! From the moment we landed in Mombasa until we left, everything was perfectly organized. The villa in Watamu was breathtaking."</p>
                        <div class="testimonial-author">
                            <h4>James Omondi</h4>
                            <p>From Kampala, Uganda</p>
                            <div class="rating">★★★★★</div>
                        </div>
                    </div>
                </div>
                
                <!-- Testimonial 5 -->
                <div class="testimonial-slide">
                    <div class="testimonial-content">
                        <p>"I've used PwaniStays three times now for business retreats. Their corporate packages are excellent and the team is very professional."</p>
                        <div class="testimonial-author">
                            <h4>Fatima Ali</h4>
                            <p>From Dubai, UAE</p>
                            <div class="rating">★★★★★</div>
                        </div>
                    </div>
                </div>
                
                <!-- Testimonial 6 -->
                <div class="testimonial-slide">
                    <div class="testimonial-content">
                        <p>"The Shanzu apartment was exactly as pictured. Clean, modern, and perfectly located. The local host was incredibly helpful with restaurant recommendations."</p>
                        <div class="testimonial-author">
                            <h4>Robert Chen</h4>
                            <p>From Shanghai, China</p>
                            <div class="rating">★★★★★</div>
                        </div>
                    </div>
                </div>
                
                <!-- Testimonial 7 -->
                <div class="testimonial-slide">
                    <div class="testimonial-content">
                        <p>"Perfect for our large family reunion. The 6-bedroom villa in Diani accommodated all 12 of us comfortably. The chef prepared amazing Swahili dishes!"</p>
                        <div class="testimonial-author">
                            <h4>The Patel Family</h4>
                            <p>From Mumbai, India</p>
                            <div class="rating">★★★★★</div>
                        </div>
                    </div>
                </div>
                
                <!-- Testimonial 8 -->
                <div class="testimonial-slide">
                    <div class="testimonial-content">
                        <p>"As a solo female traveler, I felt completely safe and well taken care of. The PwaniStays team checked in regularly and were always available."</p>
                        <div class="testimonial-author">
                            <h4>Sophie Martin</h4>
                            <p>From Paris, France</p>
                            <div class="rating">★★★★★</div>
                        </div>
                    </div>
                </div>
                
                <!-- Testimonial 9 -->
                <div class="testimonial-slide">
                    <div class="testimonial-content">
                        <p>"We booked last minute and were amazed by how quickly they arranged everything. The transfer was waiting at the airport as promised."</p>
                        <div class="testimonial-author">
                            <h4>Michael & Grace</h4>
                            <p>From Johannesburg, South Africa</p>
                            <div class="rating">★★★★★</div>
                        </div>
                    </div>
                </div>
                
                <!-- Testimonial 10 -->
                <div class="testimonial-slide">
                    <div class="testimonial-content">
                        <p>"The marine experiences they arranged were unforgettable. Snorkeling in Watamu Marine Park was the highlight of our trip."</p>
                        <div class="testimonial-author">
                            <h4>Carlos Rodriguez</h4>
                            <p>From Barcelona, Spain</p>
                            <div class="rating">★★★★★</div>
                        </div>
                    </div>
                </div>
                
                <!-- Testimonial 11 -->
                <div class="testimonial-slide">
                    <div class="testimonial-content">
                        <p>"Excellent value for money. The Nyali villa was luxurious but affordable, especially with the direct booking discount they offered."</p>
                        <div class="testimonial-author">
                            <h4>Linda Wang</h4>
                            <p>From Singapore</p>
                            <div class="rating">★★★★★</div>
                        </div>
                    </div>
                </div>
                
                <!-- Testimonial 12 -->
                <div class="testimonial-slide">
                    <div class="testimonial-content">
                        <p>"We've been coming to the Kenyan coast for years, but this was our first time using PwaniStays. It was by far our best experience yet!"</p>
                        <div class="testimonial-author">
                            <h4>The Smith Family</h4>
                            <p>From Sydney, Australia</p>
                            <div class="rating">★★★★★</div>
                        </div>
                    </div>
                </div>
            </div>
            <button class="testimonial-prev" aria-label="Previous testimonial">‹</button>
            <button class="testimonial-next" aria-label="Next testimonial">›</button>
            <div class="testimonial-dots"></div>
        </div>
    </section>

    <!-- NEW: Leave Feedback Section -->
    <section class="leave-feedback" id="leave-feedback">
        <div class="section-title">
            <h2>Share Your Experience</h2>
            <p>Tell us about your stay with PwaniStays</p>
        </div>
        
        <div class="feedback-form">
            <h3>Leave Your Feedback</h3>
            
            <div class="form-group">
                <label for="feedbackName">Your Name *</label>
                <input type="text" id="feedbackName" placeholder="Enter your full name" required>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="feedbackCity">City</label>
                    <input type="text" id="feedbackCity" placeholder="e.g., Nairobi, London">
                </div>
                
                <div class="form-group">
                    <label for="feedbackCountry">Country</label>
                    <input type="text" id="feedbackCountry" placeholder="e.g., Kenya, USA">
                </div>
            </div>
            
            <div class="form-group">
                <label>Your Rating *</label>
                <div class="star-rating">
                    <span class="star" data-rating="1">★</span>
                    <span class="star" data-rating="2">★</span>
                    <span class="star" data-rating="3">★</span>
                    <span class="star" data-rating="4">★</span>
                    <span class="star" data-rating="5">★</span>
                </div>
                <div class="rating-text" id="ratingText">Click to rate your experience</div>
            </div>
            
            <div class="form-group">
                <label for="feedbackComment">Your Review *</label>
                <textarea id="feedbackComment" rows="5" placeholder="Tell us about your experience with PwaniStays..." required></textarea>
            </div>
            
            <button class="feedback-btn" onclick="submitFeedback()" id="submitFeedbackBtn">
                Submit Your Review
            </button>
            
            <div id="feedbackMessage" style="margin-top: 20px; text-align: center; display: none;"></div>
        </div>
    </section>

    <!-- Coastal Destinations -->
    <section class="destinations" id="destinations" role="region" aria-label="Coastal destinations">
        <div class="section-title">
            <h2>Explore Kenyan Coast Destinations</h2>
            <p>From historic Mombasa to pristine Diani</p>
        </div>
        <div class="destinations-container">
            <div class="destination-card">
                <!-- UPDATED: Added proper Mombasa thumbnail image -->
                <div class="destination-image" style="background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('https://images.unsplash.com/photo-1555396273-367ea4eb4db5?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'); background-size: cover; background-position: center;">
                    <h3>Mombasa</h3>
                </div>
                <div class="destination-content">
                    <p>Historic Old Town, Fort Jesus, and vibrant markets. Perfect for culture enthusiasts.</p>
                    <a href="#" onclick="filterByLocation('Mombasa')" class="btn-small">View Properties</a>
                </div>
            </div>
            <div class="destination-card">
                <div class="destination-image" style="background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('https://images.unsplash.com/photo-1544551763-46a013bb70d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'); background-size: cover; background-position: center;">
                    <h3>Diani</h3>
                </div>
                <div class="destination-content">
                    <p>White sandy beaches, luxury resorts, and water sports. Ideal for beach lovers.</p>
                    <a href="#" onclick="filterByLocation('Diani')" class="btn-small">View Properties</a>
                </div>
            </div>
            <div class="destination-card">
                <div class="destination-image" style="background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('https://images.unsplash.com/photo-1520250497591-112f2f40a3f4?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'); background-size: cover; background-position: center;">
                    <h3>Watamu</h3>
                </div>
                <div class="destination-content">
                    <p>Marine National Park, snorkeling, and turtle watching. Great for marine adventures.</p>
                    <a href="#" onclick="filterByLocation('Watamu')" class="btn-small">View Properties</a>
                </div>
            </div>
            <div class="destination-card">
                <div class="destination-image" style="background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'); background-size: cover; background-position: center;">
                    <h3>Nyali & Bamburi</h3>
                </div>
                <div class="destination-content">
                    <p>Family-friendly beaches, restaurants, and entertainment. Perfect for family vacations.</p>
                    <a href="#" onclick="filterByLocation('Nyali')" class="btn-small">View Properties</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section class="contact" id="contact" role="region" aria-label="Contact us">
        <div class="section-title">
            <h2>Start Your Coastal Journey</h2>
            <p>Contact our coastal experts for personalized assistance</p>
        </div>
        <div class="contact-container">
            <div class="contact-info">
                <div class="contact-item">
                    <i class="fas fa-phone-alt" aria-hidden="true"></i>
                    <div>
                        <h3>Call Us Direct</h3>
                        <p><a href="tel:+254738544784">+254 738 544 784</a></p>
                        <small>Local & International calls</small>
                    </div>
                </div>
                <div class="contact-item">
                    <i class="fab fa-whatsapp" aria-hidden="true"></i>
                    <div>
                        <h3>WhatsApp Chat</h3>
                        <p><a href="https://wa.me/254738544784">+254 738 544 784</a></p>
                        <small>Instant response guaranteed</small>
                    </div>
                </div>
                <div class="contact-item">
                    <i class="fas fa-envelope" aria-hidden="true"></i>
                    <div>
                        <h3>Email Us</h3>
                        <p><a href="mailto:bookings@pwanistays.com">bookings@pwanistays.com</a></p>
                        <small>Response within 1 hour</small>
                    </div>
                </div>
                <div class="contact-item">
                    <i class="fas fa-clock" aria-hidden="true"></i>
                    <div>
                        <h3>Operating Hours</h3>
                        <p>24/7 - 365 Days</p>
                        <small>We're always available for you</small>
                    </div>
                </div>
            </div>
            <div class="contact-form" id="book-now" role="form" aria-label="Booking inquiry form">
                <h3>Send Detailed Inquiry</h3>
                <form id="inquiryForm">
                    <div class="form-group">
                        <input type="text" placeholder="Full Name *" id="name" required aria-required="true">
                    </div>
                    <div class="form-group">
                        <input type="email" placeholder="Email Address *" id="email" required aria-required="true">
                    </div>
                    <div class="form-group">
                        <input type="tel" placeholder="Phone Number with Country Code *" id="phone" required aria-required="true">
                    </div>
                    <div class="form-group">
                        <select id="service" required aria-required="true">
                            <option value="" disabled selected>Service Interested In *</option>
                            <option value="stay">Accommodation Only</option>
                            <option value="transfer">Accommodation + Transfers</option>
                            <option value="tour">Full Package (Stay + Transfers + Tours)</option>
                            <option value="corporate">Corporate/Group Booking</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <textarea placeholder="Your Detailed Requirements (Travel dates, group size, budget, special requests) *" 
                                  rows="5" id="message" required aria-required="true"></textarea>
                    </div>
                    <button type="submit" class="submit-btn">Send Detailed Inquiry</button>
                </form>
            </div>
        </div>
    </section>

    <!-- UPDATED: Footer with working navigation links -->
    <footer role="contentinfo">
        <div class="footer-container">
            <div class="footer-col">
                <!-- UPDATED FOOTER LOGO -->
                <div class="footer-logo">
                    <img src="/logo-footer.png" 
                         alt="PwaniStays - Luxury Coastal Stays" 
                         class="logo-desktop"
                         style="height: 60px; width: auto; margin-bottom: 20px;">
                    <img src="/logo-mobile.png" 
                         alt="PwaniStays" 
                         class="logo-mobile"
                         style="height: 60px; width: auto; margin-bottom: 20px;">
                </div>
                <p>Your trusted coastal accommodation partner in Kenya since 2020. We specialize in premium beachfront properties across the Kenyan coast with a focus on authentic experiences and seamless service.</p>
                <div class="social-links">
                    <!-- UPDATED: Removed TripAdvisor and X, updated Instagram username -->
                    <a href="https://www.facebook.com/pwanistays" target="_blank" rel="noopener noreferrer" title="Facebook" aria-label="Facebook">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="https://www.instagram.com/pwanistayscom" target="_blank" rel="noopener noreferrer" title="Instagram" aria-label="Instagram">
                        <i class="fab fa-instagram"></i>
                    </a>
                    <a href="https://www.tiktok.com/@pwanistays.com" target="_blank" rel="noopener noreferrer" title="TikTok" aria-label="TikTok">
                        <i class="fab fa-tiktok"></i>
                    </a>
                </div>
            </div>
            <div class="footer-col">
                <h3>Quick Links</h3>
                <ul>
                    <!-- UPDATED: Working navigation links -->
                    <li><a href="#home">Home</a></li>
                    <li><a href="#stays">Featured Properties</a></li>
                    <li><a href="#services">Our Services</a></li>
                    <li><a href="#testimonials">Guest Reviews</a></li>
                    <li><a href="#leave-feedback">Leave Feedback</a></li>
                    <li><a href="#contact">Contact Us</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h3>Coastal Destinations</h3>
                <ul>
                    <!-- UPDATED: Working location filter links -->
                    <li><a href="javascript:void(0)" onclick="filterByLocation('Mombasa')">Mombasa</a></li>
                    <li><a href="javascript:void(0)" onclick="filterByLocation('Nyali')">Nyali</a></li>
                    <li><a href="javascript:void(0)" onclick="filterByLocation('Bamburi')">Bamburi</a></li>
                    <li><a href="javascript:void(0)" onclick="filterByLocation('Diani')">Diani</a></li>
                    <li><a href="javascript:void(0)" onclick="filterByLocation('Watamu')">Watamu</a></li>
                    <li><a href="javascript:void(0)" onclick="filterByLocation('Kilifi')">Kilifi</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h3>Contact & Support</h3>
                <ul class="contact-info">
                    <li><i class="fas fa-map-marker-alt"></i> Mombasa, Coastal Kenya</li>
                    <li><i class="fas fa-phone"></i> <a href="tel:+254738544784">+254 738 544 784</a></li>
                    <li><i class="fab fa-whatsapp"></i> <a href="https://wa.me/254738544784">WhatsApp Chat</a></li>
                    <li><i class="fas fa-envelope"></i> <a href="mailto:bookings@pwanistays.com">bookings@pwanistays.com</a></li>
                    <li><i class="fas fa-clock"></i> 24/7 Customer Support</li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; <span id="currentYear"></span> PwaniStays. All rights reserved. | 
               <a href="/privacy">Privacy Policy</a> | 
               <a href="/terms">Terms of Service</a> | 
               <a href="/cancellation">Cancellation Policy</a>
            </p>
        </div>
    </footer>

    <!-- Supabase JS - Initialize Supabase ONE TIME ONLY -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        const SUPABASE_URL = "https://aanyrtsfeeynykskwxen.supabase.co";
        const SUPABASE_KEY = "sb_publishable_jda30uQX9ZzR_V8CzkeERw_nfx-QWkD";

        if (!window.supabaseClient) {
            window.supabaseClient = window.supabase.createClient(
                SUPABASE_URL,
                SUPABASE_KEY
            );
        }
    </script>
    
    <!-- Swiper JS -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <script>
        // Wrap ALL logic in DOMContentLoaded
        document.addEventListener("DOMContentLoaded", () => {
            
            // Use the globally initialized Supabase client
            const supabase = window.supabaseClient;
            
            // ==========================
            // Calendar Variables
            // ==========================
            let selectedCheckin = null;
            let selectedCheckout = null;
            let currentMonth = new Date().getMonth();
            let currentYear = new Date().getFullYear();
            let isCalendarVisible = false;

            // ==========================
            // Global Functions for HTML onclick
            // ==========================
            window.showCalendar = function() {
                generateCalendar();
                
                document.getElementById('calendarContainer').style.display = 'block';
                document.getElementById('calendarBackdrop').style.display = 'block';
                isCalendarVisible = true;
                
                document.body.style.overflow = 'hidden';
            };

            window.hideCalendar = function() {
                document.getElementById('calendarContainer').style.display = 'none';
                document.getElementById('calendarBackdrop').style.display = 'none';
                isCalendarVisible = false;
                
                document.body.style.overflow = '';
            };

            window.searchProperties = async function() {
                const location = document.getElementById('searchLocation').value;
                const propertyType = document.getElementById('propertyType').value;
                
                // Show search results section
                document.getElementById('searchResults').style.display = 'block';
                document.getElementById('stays').style.display = 'none';
                
                // Scroll to results
                document.getElementById('searchResults').scrollIntoView({ behavior: 'smooth' });
                
                // Update results header
                const resultsHeader = document.getElementById('resultsHeader');
                const searchCriteria = document.getElementById('searchCriteria');
                const datesCriteria = document.getElementById('datesCriteria');
                
                let criteriaText = [];
                if (location) criteriaText.push(location);
                if (propertyType) {
                    const unitTypeLabels = {
                        studio: "Studio",
                        "1br": "1 Bedroom",
                        "2br": "2 Bedrooms",
                        "3br": "3 Bedrooms",
                        "4br": "4 Bedrooms",
                        "5br": "5 Bedrooms",
                        "villa": "Villa"
                    };
                    criteriaText.push(unitTypeLabels[propertyType] || propertyType);
                }
                
                searchCriteria.textContent = criteriaText.length > 0 
                    ? `Properties in ${criteriaText.join(' • ')}`
                    : 'All Properties';
                
                datesCriteria.textContent = (selectedCheckin && selectedCheckout) 
                    ? `Dates: ${formatDate(selectedCheckin)} to ${formatDate(selectedCheckout)}`
                    : 'Flexible dates';
                
                resultsHeader.style.display = 'block';
                
                // Load filtered properties
                await loadFilteredProperties(location, propertyType);
            };

            window.serviceEnquiry = function(serviceName) {
                const message = `Hello PwaniStays! I would like more information about your ${serviceName} services. Please provide details about availability, pricing, and what's included.`;
                const whatsappNumber = "254738544784";
                const encodedMessage = encodeURIComponent(message);
                
                window.open(
                    `https://wa.me/${whatsappNumber}?text=${encodedMessage}`,
                    "_blank"
                );
            };

            window.showAllProperties = function() {
                // Show search results section
                document.getElementById('searchResults').style.display = 'block';
                document.getElementById('stays').style.display = 'none';
                
                // Clear any filters
                document.getElementById('searchLocation').value = '';
                document.getElementById('propertyType').value = '';
                updateDateRangeInput();
                
                // Update results header
                const resultsHeader = document.getElementById('resultsHeader');
                const searchCriteria = document.getElementById('searchCriteria');
                const datesCriteria = document.getElementById('datesCriteria');
                
                searchCriteria.textContent = 'All Properties';
                datesCriteria.textContent = '';
                resultsHeader.style.display = 'none';
                
                // Scroll to results
                document.getElementById('searchResults').scrollIntoView({ behavior: 'smooth' });
                
                // Load all properties
                loadAllProperties();
            };

            window.filterByLocation = function(location) {
                document.getElementById('searchLocation').value = location;
                searchProperties();
            };

            window.clearSearch = function() {
                // Reset filters
                document.getElementById('searchLocation').value = '';
                document.getElementById('propertyType').value = '';
                updateDateRangeInput();
                
                // Show featured properties section
                document.getElementById('searchResults').style.display = 'none';
                document.getElementById('stays').style.display = 'block';
                
                // Scroll to featured properties
                document.getElementById('stays').scrollIntoView({ behavior: 'smooth' });
                
                // Reload featured properties
                loadFeaturedProperties();
            };

            window.submitFeedback = function() {
                const name = document.getElementById('feedbackName').value.trim();
                const city = document.getElementById('feedbackCity').value.trim();
                const country = document.getElementById('feedbackCountry').value.trim();
                const comment = document.getElementById('feedbackComment').value.trim();
                
                // Validation
                if (!name) {
                    showFeedbackMessage('Please enter your name', 'error');
                    return;
                }
                
                if (selectedRating === 0) {
                    showFeedbackMessage('Please select a rating', 'error');
                    return;
                }
                
                if (!comment) {
                    showFeedbackMessage('Please enter your review', 'error');
                    return;
                }
                
                // Disable submit button
                const submitBtn = document.getElementById('submitFeedbackBtn');
                submitBtn.disabled = true;
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Submitting...';
                
                // Simulate submission
                setTimeout(() => {
                    // Show success message
                    showFeedbackMessage('Thank you for your feedback! Your review has been submitted successfully.', 'success');
                    
                    // Reset form
                    document.getElementById('feedbackName').value = '';
                    document.getElementById('feedbackCity').value = '';
                    document.getElementById('feedbackCountry').value = '';
                    document.getElementById('feedbackComment').value = '';
                    setRating(0);
                    
                    // Re-enable button
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = 'Submit Your Review';
                    
                }, 1500);
            };

            // ==========================
            // Calendar Helper Functions
            // ==========================
            function initCalendarDates() {
                selectedCheckin = null;
                selectedCheckout = null;
                updateDateRangeInput();
            }

            function updateDateRangeInput() {
                const dateRangeInput = document.getElementById('dateRange');
                if (dateRangeInput) {
                    if (selectedCheckin && selectedCheckout) {
                        dateRangeInput.value = `${formatDate(selectedCheckin)} → ${formatDate(selectedCheckout)}`;
                    } else if (selectedCheckin) {
                        dateRangeInput.value = `${formatDate(selectedCheckin)} → Select checkout`;
                    } else {
                        dateRangeInput.value = 'Select check-in → Select check-out';
                    }
                }
            }

            function generateCalendar() {
                const calendar = document.getElementById('calendarContainer');
                const today = new Date();
                today.setHours(0, 0, 0, 0);

                let html = `
                    <div class="calendar-header">
                        <h4>Select Check-in & Check-out Dates</h4>
                        <div class="calendar-nav">
                            <button onclick="changeMonth(-1)" aria-label="Previous month">‹</button>
                            <h4>${getMonthName(currentMonth)} ${currentYear}</h4>
                            <button onclick="changeMonth(1)" aria-label="Next month">›</button>
                        </div>
                    </div>
                    <div class="calendar-grid">
                        <div class="calendar-day-header">Sun</div>
                        <div class="calendar-day-header">Mon</div>
                        <div class="calendar-day-header">Tue</div>
                        <div class="calendar-day-header">Wed</div>
                        <div class="calendar-day-header">Thu</div>
                        <div class="calendar-day-header">Fri</div>
                        <div class="calendar-day-header">Sat</div>
                `;

                const firstDay = new Date(currentYear, currentMonth, 1).getDay();
                const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();

                for (let i = 0; i < firstDay; i++) {
                    html += `<div class="calendar-day disabled"></div>`;
                }

                for (let day = 1; day <= daysInMonth; day++) {
                    const date = new Date(currentYear, currentMonth, day);
                    date.setHours(0, 0, 0, 0);

                    const isToday = isSameDay(date, today);
                    const isCheckin = selectedCheckin && isSameDay(date, selectedCheckin);
                    const isCheckout = selectedCheckout && isSameDay(date, selectedCheckout);
                    const isDisabled = date < today;
                    const isBetween =
                        selectedCheckin &&
                        selectedCheckout &&
                        date > selectedCheckin &&
                        date < selectedCheckout;

                    let className = "calendar-day";
                    if (isToday) className += " today";
                    if (isCheckin) className += " selected";
                    if (isCheckout) className += " selected";
                    if (isDisabled) className += " disabled";
                    if (isBetween) className += " between";

                    const onClick = isDisabled
                        ? ""
                        : `onclick="selectDate(${day}, ${currentMonth}, ${currentYear})"`;

                    html += `<div class="${className}" ${onClick}>${day}</div>`;
                }

                const totalCells = firstDay + daysInMonth;
                const remaining = 42 - totalCells;

                for (let i = 0; i < remaining; i++) {
                    html += `<div class="calendar-day disabled"></div>`;
                }

                html += `
                    </div>
                    <div class="selected-dates-display">
                        <div>
                            <strong>Check-in</strong><br>
                            ${selectedCheckin ? formatDate(selectedCheckin) : "Not selected"}
                        </div>
                        <div>
                            <strong>Check-out</strong><br>
                            ${selectedCheckout ? formatDate(selectedCheckout) : "Not selected"}
                        </div>
                    </div>
                    <div class="calendar-actions">
                        <button class="calendar-clear" onclick="clearDates()">Clear Dates</button>
                        <button class="calendar-apply" onclick="applyDates()">Apply Dates</button>
                    </div>
                `;

                calendar.innerHTML = html;
            }

            window.selectDate = function(day, month, year) {
                const date = new Date(year, month, day);
                date.setHours(0, 0, 0, 0);

                const today = new Date();
                today.setHours(0, 0, 0, 0);

                if (date < today) return;

                if (!selectedCheckin) {
                    selectedCheckin = date;
                    selectedCheckout = null;
                } else if (!selectedCheckout && date > selectedCheckin) {
                    selectedCheckout = date;
                } else if (isSameDay(date, selectedCheckin)) {
                    selectedCheckin = null;
                    selectedCheckout = null;
                } else if (date < selectedCheckin) {
                    selectedCheckin = date;
                    selectedCheckout = null;
                } else if (selectedCheckin && !selectedCheckout && date <= selectedCheckin) {
                    selectedCheckin = date;
                    selectedCheckout = null;
                } else {
                    selectedCheckout = date;
                }

                updateDateRangeInput();
                generateCalendar();
            };

            window.changeMonth = function(delta) {
                currentMonth += delta;
                if (currentMonth < 0) {
                    currentMonth = 11;
                    currentYear--;
                } else if (currentMonth > 11) {
                    currentMonth = 0;
                    currentYear++;
                }
                generateCalendar();
            };

            window.clearDates = function() {
                selectedCheckin = null;
                selectedCheckout = null;
                updateDateRangeInput();
                generateCalendar();
            };

            window.applyDates = function() {
                if (!selectedCheckin || !selectedCheckout) {
                    alert("Please select both check-in and check-out dates");
                    return;
                }
                
                if (selectedCheckin >= selectedCheckout) {
                    alert("Check-out date must be after check-in date");
                    return;
                }
                
                hideCalendar();
            };

            function isSameDay(date1, date2) {
                if (!date1 || !date2) return false;
                return date1.getFullYear() === date2.getFullYear() &&
                       date1.getMonth() === date2.getMonth() &&
                       date1.getDate() === date2.getDate();
            }

            function getMonthName(month) {
                const months = ['January', 'February', 'March', 'April', 'May', 'June',
                              'July', 'August', 'September', 'October', 'November', 'December'];
                return months[month];
            }

            function formatDate(date) {
                if (!date) return '';
                const day = String(date.getDate()).padStart(2, '0');
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const year = date.getFullYear();
                return `${day}/${month}/${year}`;
            }

            // ==========================
            // Property Functions
            // ==========================
            function shortUUID(uuid) {
                return uuid ? uuid.split("-")[0] : '';
            }

            async function loadFeaturedProperties() {
                const container = document.getElementById('featuredProperties');
                
                try {
                    // First try to get featured properties
                    let query = supabase
                        .from("properties")
                        .select("*")
                        .eq("is_active", true)
                        .eq("is_featured", true)
                        .order("created_at", { ascending: false })
                        .limit(6);
                    
                    const { data, error } = await query;
                    
                    if (error || !data || data.length === 0) {
                        // If no featured properties, get recent ones
                        query = supabase
                            .from("properties")
                            .select("*")
                            .eq("is_active", true)
                            .order("created_at", { ascending: false })
                            .limit(6);
                        
                        const { data: recentData, error: recentError } = await query;
                        
                        if (recentError || !recentData || recentData.length === 0) {
                            container.innerHTML = '<div class="no-properties">No featured properties at the moment.</div>';
                            return;
                        }
                        
                        displayProperties(recentData, container);
                        return;
                    }
                    
                    displayProperties(data, container);
                    
                } catch (error) {
                    console.error("Error:", error);
                    container.innerHTML = '<div class="no-properties">Unable to load featured properties.</div>';
                }
            }

            async function loadAllProperties() {
                const container = document.getElementById('propertyList');
                container.innerHTML = '<div class="loading-spinner"><i class="fas fa-spinner fa-spin"></i> Loading all properties...</div>';
                
                try {
                    const { data, error } = await supabase
                        .from("properties")
                        .select("*")
                        .eq("is_active", true)
                        .order("created_at", { ascending: false });
                    
                    if (error) {
                        console.error("Error loading properties:", error);
                        container.innerHTML = '<div class="no-properties"><p>Unable to load properties. Please try again later.</p></div>';
                        return;
                    }
                    
                    if (!data || data.length === 0) {
                        container.innerHTML = '<div class="no-properties"><p>No properties available at the moment. Check back soon!</p></div>';
                        return;
                    }
                    
                    // Clear container
                    while (container.firstChild) {
                        container.removeChild(container.firstChild);
                    }
                    
                    // Create document fragment for batch append
                    const fragment = document.createDocumentFragment();
                    const cards = [];
                    
                    // First create all cards and append to fragment
                    data.forEach(property => {
                        const card = createPropertyCard(property);
                        cards.push({ property, card });
                        fragment.appendChild(card);
                    });
                    
                    // Append all cards at once
                    container.appendChild(fragment);
                    
                    // THEN load images for each property after DOM is ready
                    setTimeout(() => {
                        cards.forEach(({ property }) => {
                            loadPropertyImages(property);
                        });
                    }, 300);
                    
                } catch (error) {
                    console.error("Error:", error);
                    container.innerHTML = '<div class="no-properties"><p>Error loading properties. Please refresh the page.</p></div>';
                }
            }

            async function loadFilteredProperties(location, propertyType) {
                const container = document.getElementById('propertyList');
                container.innerHTML = '<div class="loading-spinner"><i class="fas fa-spinner fa-spin"></i> Searching properties...</div>';
                
                try {
                    let query = supabase
                        .from("properties")
                        .select("*")
                        .eq("is_active", true);
                    
                    // Apply location filter
                    if (location && location !== '') {
                        query = query.eq('location', location);
                    }
                    
                    // Apply property type filter
                    if (propertyType && propertyType !== '') {
                        query = query.eq('unit_type', propertyType);
                    }
                    
                    query = query.order('created_at', { ascending: false });
                    
                    const { data, error } = await query;
                    
                    if (error) {
                        console.error("Search error:", error);
                        container.innerHTML = '<div class="no-properties"><i class="fas fa-exclamation-triangle"></i><p>Error searching properties. Please try again.</p></div>';
                        return;
                    }
                    
                    if (!data || data.length === 0) {
                        container.innerHTML = '<div class="no-properties"><i class="fas fa-search"></i><p>No properties found matching your search.</p><p>Try different filters or browse all properties.</p></div>';
                        return;
                    }
                    
                    // Update results count
                    document.getElementById('resultsCount').textContent = `Found ${data.length} propert${data.length === 1 ? 'y' : 'ies'}`;
                    
                    // Clear container
                    while (container.firstChild) {
                        container.removeChild(container.firstChild);
                    }
                    
                    // Create document fragment for batch append
                    const fragment = document.createDocumentFragment();
                    const cards = [];
                    
                    // First create all cards and append to fragment
                    data.forEach(property => {
                        const card = createPropertyCard(property);
                        cards.push({ property, card });
                        fragment.appendChild(card);
                    });
                    
                    // Append all cards at once
                    container.appendChild(fragment);
                    
                    // THEN load images for each property after DOM is ready
                    setTimeout(() => {
                        cards.forEach(({ property }) => {
                            loadPropertyImages(property);
                        });
                    }, 300);
                    
                } catch (error) {
                    console.error("Error:", error);
                    container.innerHTML = '<div class="no-properties"><i class="fas fa-exclamation-triangle"></i><p>Unable to search properties. Please check your connection.</p></div>';
                }
            }

            function createPropertyCard(property) {
                const card = document.createElement('div');
                card.className = 'property-card';
                const shortId = shortUUID(property.id);
                card.id = `property-${shortId}`;
                
                // Calculate price
                const displayPrice = calculateDisplayPrice(property, selectedCheckin);
                
                // Get property type display
                const unitTypeLabels = {
                    studio: "Studio",
                    "1br": "1 Bedroom",
                    "2br": "2 Bedrooms",
                    "3br": "3 Bedrooms",
                    "4br": "4 Bedrooms",
                    "5br": "5 Bedrooms",
                    "villa": "Villa"
                };
                const propertyTypeDisplay = unitTypeLabels[property.unit_type] || property.unit_type || 'Property';
                
                // Show beds from property.beds
                const bedsCount = property.beds || 1;
                const bedsDisplay = `${bedsCount} ${bedsCount === 1 ? 'Bed' : 'Beds'}`;
                
                // Escape special characters for safety
                const safeTitle = property.title ? property.title.replace(/'/g, "\\'") : 'Property';
                
                card.innerHTML = `
                    <div class="property-gallery">
                        <div class="swiper mainSwiper" id="main-${property.id}">
                            <div class="swiper-wrapper">
                                <div class="swiper-slide">
                                    <img src="https://images.unsplash.com/photo-1544551763-46a013bb70d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" 
                                         alt="${property.title || 'Property'} placeholder image"
                                         onerror="this.src='https://images.unsplash.com/photo-1544551763-46a013bb70d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'">
                                </div>
                            </div>
                            <div class="swiper-pagination"></div>
                        </div>
                        <div class="swiper thumbSwiper" id="thumb-${property.id}" style="display: none;">
                            <div class="swiper-wrapper"></div>
                        </div>
                    </div>
                    
                    <div class="property-content">
                        <h3 class="property-title">${property.title || 'Premium Property'}</h3>
                        <div class="property-meta">
                            <span class="property-location">
                                <i class="fas fa-map-marker-alt"></i> ${property.location || 'Coastal Kenya'}
                            </span>
                            <span class="property-type">${propertyTypeDisplay}</span>
                        </div>
                        
                        <ul class="property-desc" id="desc-${property.id}" data-full="${property.description || ''}">
                        </ul>
                        <button class="view-more-btn" id="toggle-${property.id}" onclick="toggleAmenities('${property.id}')" style="display: none;">
                        </button>
                        
                        <div class="property-price">Ksh ${displayPrice} <span style="font-size: 0.9rem; color: var(--gray);">/ night</span></div>
                        
                        <div class="property-footer">
                            <div class="property-info">
                                <div class="property-beds">
                                    <i class="fas fa-bed"></i> ${bedsDisplay}
                                </div>
                            </div>
                            <button class="btn-primary" onclick="checkAvailability('${property.id}', '${safeTitle}')">
                                <i class="fas fa-calendar-alt"></i> Check Availability
                            </button>
                        </div>
                    </div>
                `;
                
                // Render amenities after card is created
                setTimeout(() => {
                    renderAmenities(property.id, property.description, false);
                }, 0);
                
                return card;
            }

            window.checkAvailability = function(propertyId, propertyTitle) {
                // Get property element
                let propertyElement = document.getElementById(`property-${shortUUID(propertyId)}`);
                if (!propertyElement) {
                    propertyElement = document.getElementById(`property-${propertyId}`);
                    if (!propertyElement) {
                        console.log(`Could not find property element for ID: ${propertyId}`);
                        return;
                    }
                }
                
                // Get price
                const priceElement = propertyElement.querySelector('.property-price');
                const price = priceElement ? priceElement.textContent.replace('Ksh ', '').replace(' / night', '') : 'Price on request';
                
                // Get dates
                const checkinDate = selectedCheckin ? formatDate(selectedCheckin) : 'Not selected';
                const checkoutDate = selectedCheckout ? formatDate(selectedCheckout) : 'Not selected';
                
                // Create property object
                const property = {
                    id: propertyId,
                    title: propertyTitle
                };
                
                // Open WhatsApp
                openWhatsApp(property, checkinDate, checkoutDate, price);
            };

            window.openWhatsApp = function(property, checkin, checkout, rate) {
                const anchorId = shortUUID(property.id);
                const propertyLink = `https://pwanistays.com/#property-${anchorId}`;

                const message = `
Property: ${property.title}
Link: ${propertyLink}
Dates: ${checkin} → ${checkout}
Rate: KES ${rate}/night

Hello PwaniStays! I am interested in this property. Is it available for the selected dates?
`.trim();

                const whatsappNumber = "254738544784";
                const encodedMessage = encodeURIComponent(message);

                window.open(
                    `https://wa.me/${whatsappNumber}?text=${encodedMessage}`,
                    "_blank"
                );
            };

            // ==========================
            // Helper Functions
            // ==========================
            function calculateDisplayPrice(property, checkinDate = null) {
                if (!property) return 'N/A';
                
                const date = checkinDate || new Date();
                const isPeak = isPeakSeason(date);
                const basePrice = isPeak 
                    ? (property.peak_price || 0) 
                    : (property.low_price || 0);
                
                const finalPrice = Math.round(basePrice * 1.2);
                
                return finalPrice.toLocaleString('en-KE', {
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                });
            }

            function isPeakSeason(date) {
                if (!date) {
                    date = new Date();
                }
                const m = date.getMonth() + 1;
                const d = date.getDate();
                
                if (m === 1 && d <= 10) return true;
                if ([7, 8, 11, 12].includes(m)) return true;
                return false;
            }

            // ==========================
            // Testimonials
            // ==========================
            let currentTestimonial = 0;
            const totalTestimonials = 12;
            
            function initTestimonials() {
                const dotsContainer = document.querySelector('.testimonial-dots');
                if (!dotsContainer) return;
                
                // Create dots
                for (let i = 0; i < totalTestimonials; i++) {
                    const dot = document.createElement('button');
                    dot.className = `testimonial-dot ${i === 0 ? 'active' : ''}`;
                    dot.setAttribute('aria-label', `View testimonial ${i + 1}`);
                    dot.addEventListener('click', () => showTestimonial(i));
                    dotsContainer.appendChild(dot);
                }
                
                // Navigation buttons
                const prevBtn = document.querySelector('.testimonial-prev');
                const nextBtn = document.querySelector('.testimonial-next');
                
                if (prevBtn) prevBtn.addEventListener('click', prevTestimonial);
                if (nextBtn) nextBtn.addEventListener('click', nextTestimonial);
                
                // Auto-rotate
                setInterval(nextTestimonial, 5000);
            }
            
            function showTestimonial(index) {
                const slides = document.querySelectorAll('.testimonial-slide');
                const dots = document.querySelectorAll('.testimonial-dot');
                
                slides.forEach(slide => slide.classList.remove('active'));
                dots.forEach(dot => dot.classList.remove('active'));
                
                if (slides[index]) slides[index].classList.add('active');
                if (dots[index]) dots[index].classList.add('active');
                currentTestimonial = index;
            }
            
            function nextTestimonial() {
                currentTestimonial = (currentTestimonial + 1) % totalTestimonials;
                showTestimonial(currentTestimonial);
            }
            
            function prevTestimonial() {
                currentTestimonial = (currentTestimonial - 1 + totalTestimonials) % totalTestimonials;
                showTestimonial(currentTestimonial);
            }

            // ==========================
            // Star Rating
            // ==========================
            let selectedRating = 0;
            
            function initStarRating() {
                const stars = document.querySelectorAll('.star');
                stars.forEach(star => {
                    star.addEventListener('click', function() {
                        const rating = parseInt(this.getAttribute('data-rating'));
                        setRating(rating);
                    });
                    
                    star.addEventListener('mouseover', function() {
                        const rating = parseInt(this.getAttribute('data-rating'));
                        highlightStars(rating);
                    });
                });
                
                // Reset stars when mouse leaves rating container
                document.querySelector('.star-rating').addEventListener('mouseleave', function() {
                    highlightStars(selectedRating);
                });
            }
            
            function setRating(rating) {
                selectedRating = rating;
                highlightStars(rating);
                
                // Update rating text
                const ratingText = document.getElementById('ratingText');
                const ratingMessages = [
                    "Click to rate your experience",
                    "Poor - We'll do better",
                    "Fair - Room for improvement",
                    "Good - Satisfied with our service",
                    "Very Good - Had a great experience",
                    "Excellent - Absolutely loved it!"
                ];
                ratingText.textContent = ratingMessages[rating];
            }
            
            function highlightStars(rating) {
                const stars = document.querySelectorAll('.star');
                stars.forEach(star => {
                    const starRating = parseInt(star.getAttribute('data-rating'));
                    if (starRating <= rating) {
                        star.classList.add('selected');
                    } else {
                        star.classList.remove('selected');
                    }
                });
            }

            // ==========================
            // Other Initialization
            // ==========================
            
            // Mobile menu
            const menuToggle = document.querySelector('.menu-toggle');
            const navLinks = document.querySelector('.nav-links');
            
            if (menuToggle) {
                menuToggle.addEventListener('click', function() {
                    navLinks.classList.toggle('active');
                    const isExpanded = this.getAttribute('aria-expanded') === 'true';
                    this.setAttribute('aria-expanded', !isExpanded);
                });
                
                // Close mobile menu when clicking any link
                document.querySelectorAll('.nav-links a').forEach(link => {
                    link.addEventListener('click', (e) => {
                        if (link.getAttribute('href').startsWith('#')) {
                            navLinks.classList.remove('active');
                            menuToggle.setAttribute('aria-expanded', 'false');
                        }
                    });
                });
            }
            
            // Set current year
            document.getElementById('currentYear').textContent = new Date().getFullYear();
            
            // Initialize calendar
            initCalendarDates();
            
            // Initialize testimonials
            initTestimonials();
            
            // Initialize star rating
            initStarRating();
            
            // Form submission
            const inquiryForm = document.getElementById('inquiryForm');
            if (inquiryForm) {
                inquiryForm.addEventListener('submit', handleFormSubmit);
            }
            
            // Load properties on page load
            loadFeaturedProperties();
            
            // Close calendar when clicking backdrop
            document.getElementById('calendarBackdrop').addEventListener('click', hideCalendar);
            
            // Close calendar when pressing Escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && isCalendarVisible) {
                    hideCalendar();
                }
            });
            
            // Initialize Hero Carousel
            initHeroCarousel();
            
            // Add smooth scrolling for all internal links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    const href = this.getAttribute('href');
                    
                    if (href === '#' || href.startsWith('javascript:')) {
                        return;
                    }
                    
                    if (href !== '#') {
                        e.preventDefault();
                        
                        const targetId = href.substring(1);
                        const targetElement = document.getElementById(targetId);
                        
                        if (targetElement) {
                            window.scrollTo({
                                top: targetElement.offsetTop - 80,
                                behavior: 'smooth'
                            });
                            
                            history.pushState(null, null, href);
                        }
                    }
                });
            });

            // ==========================
            // Additional Helper Functions
            // ==========================
            
            function initHeroCarousel() {
                const heroSwiper = new Swiper('.heroSwiper', {
                    spaceBetween: 0,
                    slidesPerView: 1,
                    loop: true,
                    autoplay: {
                        delay: 7000,
                        disableOnInteraction: false,
                    },
                    speed: 1000,
                    effect: 'fade',
                    fadeEffect: {
                        crossFade: true
                    },
                    navigation: false,
                    pagination: false
                });
            }

            function displayProperties(properties, container) {
                while (container.firstChild) {
                    container.removeChild(container.firstChild);
                }
                
                const fragment = document.createDocumentFragment();
                const cards = [];
                
                properties.forEach(property => {
                    const card = createPropertyCard(property);
                    cards.push({ property, card });
                    fragment.appendChild(card);
                });
                
                container.appendChild(fragment);
                
                setTimeout(() => {
                    cards.forEach(({ property }) => {
                        loadPropertyImages(property);
                    });
                }, 300);
            }

            async function loadPropertyImages(property) {
                await new Promise(resolve => setTimeout(resolve, 100));
                
                const shortId = shortUUID(property.id);
                const card = document.querySelector(`#property-${shortId}`);
                if (!card) return;
                
                const mainWrapper = card.querySelector(`#main-${property.id} .swiper-wrapper`);
                if (!mainWrapper) return;
                
                let images = [];
                
                try {
                    const { data: files, error } = await supabase
                        .storage
                        .from('property_images')
                        .list(property.id);
                    
                    if (!error && files && files.length > 0) {
                        files.sort((a, b) => {
                            const numA = parseInt(a.name.match(/\d+/)?.[0]) || 0;
                            const numB = parseInt(b.name.match(/\d+/)?.[0]) || 0;
                            return numA - numB;
                        });
                        
                        files.forEach(file => {
                            const { data } = supabase
                                .storage
                                .from('property_images')
                                .getPublicUrl(`${property.id}/${file.name}`);
                            
                            if (data && data.publicUrl) {
                                images.push(data.publicUrl);
                            }
                        });
                    }
                } catch (error) {
                    console.log(`Error loading storage images for property ${property.id}:`, error);
                }
                
                if (images.length === 0) {
                    if (property.image_url) {
                        images.push(property.image_url);
                    } else {
                        images.push('https://images.unsplash.com/photo-1544551763-46a013bb70d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80');
                    }
                }
                
                mainWrapper.innerHTML = '';
                
                const thumbWrapper = card.querySelector(`#thumb-${property.id} .swiper-wrapper`);
                if (thumbWrapper) thumbWrapper.innerHTML = '';
                
                images.forEach((url, index) => {
                    mainWrapper.innerHTML += `
                        <div class="swiper-slide">
                            <img src="${url}" alt="${property.title || 'Property'} image ${index + 1}" 
                                 onerror="this.src='https://images.unsplash.com/photo-1544551763-46a013bb70d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'">
                        </div>
                    `;
                    
                    if (thumbWrapper && images.length > 1) {
                        thumbWrapper.innerHTML += `
                            <div class="swiper-slide">
                                <img src="${url}" alt="${property.title || 'Property'} thumbnail ${index + 1}"
                                     onerror="this.src='https://images.unsplash.com/photo-1544551763-46a013bb70d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'">
                            </div>
                        `;
                    }
                });
                
                setTimeout(() => {
                    initializePropertySwiper(property.id, images);
                }, 200);
            }

            function initializePropertySwiper(propertyId, images) {
                const mainSwiperElement = document.querySelector(`#main-${propertyId}`);
                const thumbSwiperElement = document.querySelector(`#thumb-${propertyId}`);
                
                if (!mainSwiperElement) return null;
                
                if (mainSwiperElement.swiper) {
                    mainSwiperElement.swiper.destroy(true, true);
                }
                
                if (thumbSwiperElement && thumbSwiperElement.swiper) {
                    thumbSwiperElement.swiper.destroy(true, true);
                }
                
                let thumbsSwiper = null;
                if (images.length > 1 && thumbSwiperElement) {
                    thumbSwiperElement.style.display = 'block';
                    
                    thumbsSwiper = new Swiper(thumbSwiperElement, {
                        spaceBetween: 8,
                        slidesPerView: Math.min(4, images.length),
                        freeMode: true,
                        watchSlidesProgress: true,
                        breakpoints: {
                            320: { slidesPerView: Math.min(3, images.length) },
                            768: { slidesPerView: Math.min(4, images.length) }
                        }
                    });
                } else if (thumbSwiperElement) {
                    thumbSwiperElement.style.display = 'none';
                }
                
                const mainSwiper = new Swiper(mainSwiperElement, {
                    spaceBetween: 0,
                    loop: images.length > 1,
                    pagination: {
                        el: mainSwiperElement.querySelector('.swiper-pagination'),
                        clickable: true,
                        dynamicBullets: true
                    },
                    navigation: false,
                    thumbs: thumbsSwiper ? { swiper: thumbsSwiper } : undefined,
                    autoplay: images.length > 1 ? {
                        delay: 3000,
                        disableOnInteraction: false,
                    } : false,
                    effect: 'slide',
                    speed: 500,
                    preloadImages: false,
                    lazy: {
                        loadPrevNext: true,
                    }
                });
                
                return mainSwiper;
            }

            function renderAmenities(propertyId, description, expanded = false) {
                const container = document.getElementById(`desc-${propertyId}`);
                const toggleBtn = document.getElementById(`toggle-${propertyId}`);

                if (!container || !description) return;

                const amenities = description.split('\n').filter(line => line.trim().length > 0);
                const visible = expanded ? amenities : amenities.slice(0, 4);

                container.innerHTML = visible.map(amenity => `<li>${amenity.trim()}</li>`).join('');

                if (amenities.length > 4) {
                    toggleBtn.style.display = 'inline-block';
                    toggleBtn.textContent = expanded
                        ? 'View Less'
                        : `+ ${amenities.length - 4} more amenities`;
                } else {
                    toggleBtn.style.display = 'none';
                }
            }

            window.toggleAmenities = function(propertyId) {
                const container = document.getElementById(`desc-${propertyId}`);
                const isExpanded = container.classList.toggle('expanded');
                
                const fullDescription = container.dataset.full || '';
                
                renderAmenities(
                    propertyId,
                    fullDescription,
                    isExpanded
                );
            };

            function handleFormSubmit(e) {
                e.preventDefault();
                
                const formData = {
                    name: document.getElementById('name').value.trim(),
                    email: document.getElementById('email').value.trim(),
                    phone: document.getElementById('phone').value.trim(),
                    service: document.getElementById('service').value,
                    message: document.getElementById('message').value.trim()
                };
                
                if (!formData.name || !formData.email || !formData.phone || !formData.service || !formData.message) {
                    alert('Please fill all required fields marked with *');
                    return;
                }
                
                alert(`Thank you ${formData.name}! Our coastal experts will contact you within 30 minutes.`);
                e.target.reset();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }

            function showFeedbackMessage(message, type) {
                const messageDiv = document.getElementById('feedbackMessage');
                messageDiv.textContent = message;
                messageDiv.style.color = type === 'error' ? '#dc3545' : '#28a745';
                messageDiv.style.display = 'block';
                
                setTimeout(() => {
                    messageDiv.style.display = 'none';
                }, 5000);
            }

        }); // End of DOMContentLoaded
    </script>
</body>
</html>